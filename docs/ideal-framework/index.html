<!doctype html><html><head><title>The Ideal Framework | Trooba</title><link rel="icon" type="image/png" sizes="32x21" href="/favicon-21709fb7.png"><meta name="viewport" content="width=device-width, initial-scale=1"><script>
        var scalingBodyFont = false;

        function scaleBodyFont() {
            var height = Math.max(window.outerHeight, window.screen.height);
            document.documentElement.style.fontSize = Math.pow(Math.min(window.innerWidth, height), 0.25)*19+'%';
            scalingBodyFont = false;
        }

        window.addEventListener('resize', function() {
            requestAnimationFrame(scaleBodyFont);
        });

        scaleBodyFont();
    </script><link rel="stylesheet" href="/docs-840cda31.css"></head><body class="docs"><header class="site-header" id="s0"><a href="/"><img src="/logo-header-3015f806.png" class="site-logo"></a><div class="stuff"><nav class="site-menu"><a href="/docs/introduction-overview/">Getting started</a><a href="/docs/trooba-book-overview/">Book</a><a href="https://github.com/trooba/trooba">github</a><form class="site-search search" id="s0-c0" data-marko='{"onclick":"focus s0-c0","onsubmit":"search s0-c0"}'><img src="/search-c29a7d7d.png"><input type="search" placeholder="search the docs..." id="s0-c0-input"></form></nav><button class="menu" data-marko='{"onclick":"emit s0 0"}'>&#9776;</button></div></header><div class="doc-sidebar" id="s1-sidebar"><button class="close" data-marko='{"onclick":"hide s1"}'>&#10005;</button><h1>Trooba <select id="s1-c0" data-marko='{"onchange":"switchVersion s1-c0"}'><option value="current" selected>2.0.2</option></select></h1><form class="site-search search" id="s1-c1" data-marko='{"onclick":"focus s1-c1","onsubmit":"search s1-c1"}'><img src="/search-c29a7d7d.png"><input type="search" placeholder="search the docs..." id="s1-c1-input"></form><ul class="toc-level0"><li class="section"><a href="/docs/introduction-overview/">INTRODUCTION</a></li><li><a href="/docs/installing/">Installing</a></li><li><a href="/docs/getting-started/">Getting Started</a></li><li><a href="/docs/api/">API</a></li><li><a href="/docs/handlers/">Handlers</a></li><li><a href="/docs/transports/">Transports</a></li><li><a href="/docs/custom-api/">Custom API</a></li><li><a href="/docs/streaming/">Streaming</a></li><li><a href="/docs/tracing/">Tracing</a></li><li><a href="/docs/enforcing-delivery/">Enforcing Delivery</a></li></ul><ul class="toc-level0"><li class="section"><a href="/docs/trooba-book-overview/">TROOBA BOOK</a></li><li><a href="/docs/scalable-pipelines/">Scalable Pipelines</a></li><li><a class="selected" href="/docs/ideal-framework/">Ideal Framework</a><ul class="toc toc-level1"><li><a href="#why-do-we-need-a-framework">Why do we need a framework?</a><ul class="toc toc-level2"><li><a href="#what-it-takes-to-make-an-http-service-call">What it takes to make an http service call?</a></li><li><a href="#will-this-scale">Will this scale?</a></li><li><a href="#what-is-available">What is available?</a></li><li><a href="#what-do-we-want-our-framework-to-be">What do we want our framework to be?</a></li><li><a href="#what-use-cases-do-we-want-to-support">What use-cases do we want to support?</a></li><li><a href="#why-not-use-a-popular-middleware-pattern">Why not use a popular middleware pattern?</a></li></ul></li></ul></li><li><a href="/docs/separation-of-concerns/">Separation Of Concerns</a></li><li><a href="/docs/using-trooba/">Using Trooba</a></li><li><a href="/docs/bootstrapping-from-config/">Bootstrapping From Config</a></li><li><a href="/docs/pipelines-everywhere/">Pipelines Everywhere!</a></li><li><a href="/docs/pipeline-lifecycle/">Pipeline Lifecycle</a></li><li><a href="/docs/transport-with-context/">Transport With Context</a></li></ul></div><div class="content"><div class="doc-layout"><div class="doc-container"><div class="doc-content"><h1 id="the-ideal-framework"><a name="the-ideal-framework" class="anchor" href="#the-ideal-framework"><span class="header-link"></span></a>The Ideal Framework</h1><p>In this series we are going to explain the reasons behind architecture of eBay open-source pipeline framework called Trooba.</p><h2 id="why-do-we-need-a-framework"><a name="why-do-we-need-a-framework" class="anchor" href="#why-do-we-need-a-framework"><span class="header-link"></span></a>Why do we need a framework?</h2><p>One of the goals while building enterprise platform is to minimize the energy spent on maintaining a platform while supporting growing number of applications and teams that use it. This is usually accomplished with the use of various frameworks.</p><p>The framework defines uniform guidelines on how things should be done; which allows to maintain the same structure of the system, keeps it recognizable to other developers and reduces maintenance costs.</p><p>The application developers no longer need to architect/implement their way of doing service calls and focus their time on the application business logic. The frameworks can also allow to structure service data flow into a separate testable components. These components are usually build by platform or framework team and then distributed to other teams that use them in their service data flows.</p><p>The framework needs to be simple enough to guarantee a quick on-boarding of new developers and teams, provide tools for fast debugging and troubleshooting. It is better be based on open standards and allow to form a developer community around to set it on self-sustainable path via contributions.</p><p>There are already many frameworks out there that organize how things should be done. Marko, React or Angular define rules on how UI should be done. The frontend and backend services are based on Express, Hapi, Kraken-js, etc. Microservice infrastructure can be built using Hemera or Senecajs.</p><p>Let&#39;s look at a simple example to understand how frameworks simplify things.</p><h3 id="what-it-takes-to-make-an-http-service-call"><a name="what-it-takes-to-make-an-http-service-call" class="anchor" href="#what-it-takes-to-make-an-http-service-call"><span class="header-link"></span></a>What it takes to make an http service call?</h3><ul><li>Create an HTTP client</li><li>Initiate a call</li><li>Wait for response</li><li>Handle edge cases and return data to the caller</li></ul><p>Here’s high level diagram:</p><p><img src="/service-call-diagram-e20ad70e.png" alt="service call diagram" width=709 height=426></p><h3 id="will-this-scale"><a name="will-this-scale" class="anchor" href="#will-this-scale"><span class="header-link"></span></a>Will this scale?</h3><p>What if you need to …</p><ul><li>Provide secure token in the header</li><li>A/B testing</li><li>Analytics</li><li>Validate client before making a call</li><li>Generate trace events to central logging repository</li><li>Upgrade service client code in all 1000+ application</li></ul><p>Should we ask every application developer to do this job?</p><p>The answer is obvious - framework should do this automatically and transparently to the user.</p><h3 id="what-is-available"><a name="what-is-available" class="anchor" href="#what-is-available"><span class="header-link"></span></a>What is available?</h3><ul><li>http and https core modules that are not generic, low level, bound to http protocol and still require a lot of work from a developer.</li><li>request is http module, very popular still requires a lot of work from a developer.</li><li>wreak from hapi team (http protocol) focuses on http protocol, still low level.</li><li>axios is a next level comparing to the earlier mentioned modules, provides a pipeline support via hooks, isomorphic but still http bound.</li><li>Seneca.js is very good microservice framework, limited to nodejs environment and hard to build pipelines.</li><li>Hemera is similar to seneca and goes higher with abstracting transport into NATS framework supported by multiple languages, almost perfect, but still hard to build pipelines.</li><li>gRPC is low latency, streaming support, multiplexing channels, protocol oriented, still no way to build pipelines.</li></ul><p>Some concerns listed among benefits should not be considered as a bad side of the frameworks being reviewed. Maybe this is how it should be, we do not want to have a framework that does all kinds of things possible as it goes agains modular approach. What is missing is some generic way of connecting all good parts and defining structure for these connections that would allow to scale to many applications. </p><h3 id="what-do-we-want-our-framework-to-be"><a name="what-do-we-want-our-framework-to-be" class="anchor" href="#what-do-we-want-our-framework-to-be"><span class="header-link"></span></a>What do we want our framework to be?</h3><p>What we want is to have a framework that would allows us to easily connect or use the above mentioned frameworks and modules.</p><ul><li>Generic: should not dictate low level logic on how things should be done</li><li>Isomorphic: used in browser and at server side</li><li>Minimalistic: simple and familiar interface, allow superagent API or gRPC proto API, for example</li><li>Modular: allow more complex compositions out of basic elements</li><li>Protocol and transport free where transport is replaceable without application code change</li><li>Customizable: a developer can add its own instruments/hooks</li><li>Support existing and new use-cases (see below)</li><li>Able to use good parts provided by above frameworks</li><li>Be an extension to other frameworks, not always a replacement</li></ul><h3 id="what-use-cases-do-we-want-to-support"><a name="what-use-cases-do-we-want-to-support" class="anchor" href="#what-use-cases-do-we-want-to-support"><span class="header-link"></span></a>What use-cases do we want to support?</h3><ul><li>Pub/Sub</li><li>Request/Response</li><li>Request/Response stream</li><li>Request stream/Response</li><li>Request stream/Response stream</li></ul><h3 id="why-not-use-a-popular-middleware-pattern"><a name="why-not-use-a-popular-middleware-pattern" class="anchor" href="#why-not-use-a-popular-middleware-pattern"><span class="header-link"></span></a>Why not use a popular middleware pattern?</h3><p><img src="/service-call-diagram-pattern-17d1d895.png" alt="service call diagram" width=712 height=428></p><p>That’s the idea that will give us the same manageable structure to to make service calls as express did to the incoming http traffic.</p><p>In the next chapter we will continue exploring what we need to create a scalable pipeline framework for making service calls in Node.JS app.</p><a href="https://github.com/trooba/trooba-book/blob/master/book/ideal-framework.md" class="edit-on-github">EDIT <img src="/github-02f398dc.svg"></a><h2 id="contributors"><a name="contributors" class="anchor" href="#contributors"><span class="header-link"></span></a> Contributors</h2><p>Helpful? You can thank these awesome people! You can also <a href="https://github.com/trooba/trooba/blob/master/docs/ideal-framework.md">edit this doc</a> if you see any issues or want to improve it.</p><div class="contributors"><a href="https://github.com/trooba/trooba/blob/master/docs/ideal-framework.md" class="contributor you"><div class="photo"><span class="icon">+</span></div><span class="name">You?</span></a></div><script>(function(){var w=window;w.$components=(w.$components||[]).concat({"w":[["s0-c0",1,{"class":"search"},{"d":[["blur","shrink","s0-c0-input",null],["focus","grow","s0-c0-input",null]]}],["s0",0,{},{"b":[["toggle-menu"]]}],["s1-c0",3,{},{}],["s1-c1",1,{"class":"search"},{"d":[["blur","shrink","s1-c1-input",null],["focus","grow","s1-c1-input",null]]}],["s1",2,{"doc":"ideal-framework","toc":"<ul class=\"toc toc-level1\"><li><a href=\"#why-do-we-need-a-framework\">Why do we need a framework?\u003C/a><ul class=\"toc toc-level2\"><li><a href=\"#what-it-takes-to-make-an-http-service-call\">What it takes to make an http service call?\u003C/a>\u003C/li><li><a href=\"#will-this-scale\">Will this scale?\u003C/a>\u003C/li><li><a href=\"#what-is-available\">What is available?\u003C/a>\u003C/li><li><a href=\"#what-do-we-want-our-framework-to-be\">What do we want our framework to be?\u003C/a>\u003C/li><li><a href=\"#what-use-cases-do-we-want-to-support\">What use-cases do we want to support?\u003C/a>\u003C/li><li><a href=\"#why-not-use-a-popular-middleware-pattern\">Why not use a popular middleware pattern?\u003C/a>\u003C/li>\u003C/ul>\u003C/li>\u003C/ul>"},{"r":["sidebar"]}]],"t":["/trooba-website$1.0.0/components/site-header/component-browser","/trooba-website$1.0.0/components/site-search/component-browser","/trooba-website$1.0.0/components/doc-sidebar/component-browser","/trooba-website$1.0.0/components/doc-sidebar/components/version-switcher/component-browser"]})||w.$components})()</script><footer class="site-footer doc-footer"><span><img src="/ebay-e69eedab.svg"> open source</span><div class="copyright">Copyright &copy; 2017 eBay Inc. &mdash; <a href="https://github.com/trooba/trooba/blob/master/LICENSE">The MIT License</a></div></footer></div></div></div></div><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-103058606-1', 'trooba.github.io');
ga('send', 'pageview');
</script><script>
    ((window.gitter = {}).chat = {}).options = {
      room: 'trooba/general'
    };
    </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script><script src="/docs-1c73820e.js"></script>
<script>$_mod.ready();</script></body></html>